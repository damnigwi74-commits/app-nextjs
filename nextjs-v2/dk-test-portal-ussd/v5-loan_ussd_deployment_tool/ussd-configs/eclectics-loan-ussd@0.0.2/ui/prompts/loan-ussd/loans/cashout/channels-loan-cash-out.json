[
  {
    "type": "skip",
    "name": "fetch-wallet-balance",
    "action": "update-parameters",
    "external-fetch": {
      "route": "wallet-balance",
      "success": "channels-loan-cash-out-provider",
      "error": "wallet-balance-error",
      "cache": true,
      "cache-path": "global-request-details",
      "cache-parameters": [
        {
          "path": "data.availableBal",
          "save-as": "walletBalance",
          "format-as": "balance-timestamp",
          "default": ""
        }
      ]
    },
    "on-cancel": "client-page"
  },
  {
    "type": "select",
    "name": "channels-loan-cash-out-provider",
    "save-as": "loanCashOut",
    "save-as-label": "loanLabelCashOut",
    "options": [
      {
        "label": "MPESA",
        "value": "mpesa"
      }
    ],
    "format-as":"formatLoanLimitMinimumAmount",
    "error": "channels-loan-cash-out-provider-error",
    "previous": "client-page",
    "next": "channels-loan-cash-out-amount"
  },
  {
    "type": "input",
    "name": "channels-loan-cash-out-amount",
    "save-as": "loanAmount",
    "validation": [
      {
        "name": "isWithinLoanLimit",
        "type": "custom",
        "arguments": "min=%@minLoanAmount, max=%@walletBalance"
      },
      {
        "name": "isAmount",
        "type": "joi",
        "arguments": "min=100"
      }
    ],
    "error": "channels-loan-cash-out-amount-error",
    "previous": "channels-loan-cash-out-provider",
    "next": "channels-loan-cash-out-confirm"
  },
  {
    "type": "select",
    "name": "channels-loan-cash-out-confirm",
    "options": "confirm-options",
    "error": "channels-loan-cash-out-confirm-error",
    "action": "transact",
    "external-fetch": {
      "route": "loan-cash-out",
      "success": "channels-loan-cash-out-api-success",
      "error": "api-error",
      "cache": true,
      "cache-path": "global-request-details",
      "cache-parameters": [
        {
          "path": "message",
          "save-as": "cashOutSuccess"
        }
      ]
    },
    "on-cancel": "client-page",
    "previous": "channels-loan-cash-out-amount"
  },
  {
    "type": "select",
    "name": "channels-loan-cash-out-api-success",
    "options": "yes-no-options",
    "error": "-channels-loan-cash-out-api-success-error",
    "action": "navigate",
    "on-accept": "client-page",
    "on-cancel": "logout"
  }
]
