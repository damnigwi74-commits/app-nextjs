[
    {
        "type"          : "input",
        "name"          : "merchant-payment-code",
        "save-as"       : "merchantCode",
        "validation"    : [
            {
                "name": "isAlphaNumeric",
                "type": "custom"
            }
        ],
        "error"         : "merchant-payment-code-error",
        "previous"      : "client-page",
        "next"          : "merchant-payment-amount",		
		"action"         : "update-parameters",
		"external-fetch" : { 
			"route"            : "merchant-payment-lookup",
			"success"          : "merchant-payment-amount",	
			"error"            : "merchant-payment-amount",
			"cache"            : true,
			"cache-path"       : "global-request-details",
			"cache-parameters" : [
				{
					"path"     : "data.transaction_details",
					"save-as"  : "lookupMerchant"
                },
                {
					"path"     : "data.transaction_details.debit_account",
					"save-as"  : "merchantAccount",
                    "format-as": "walletAccount"
                },
                {
					"path"     : "data.transaction_details.branch_name",
					"save-as"  : "merchantName",
                    "format-as": ""
                }
			]        
		}
    },
    {
        "type": "select",
        "name": "merchant-payment-accounts",
        "save-as": "merchantPayDebitAcc",
        "options": [
            {
				"label": "My Accounts",
                "jump-to": "merchant-payment-debit-account"
            },
            {
				"label": "From MPESA",
                "value" : "__walletAccount",
                "jump-to": "mpesa-merchant-amount"
            }
        ],
		"error": "merchant-payment-accounts-error",
		"next" :"merchant-payment-debit-account",
        "previous": "merchant-payment-code"
    },
    {
        "type"          : "select",
		"name"          : "merchant-payment-debit-account",
		"save-as"       : "merchantPayDebitAcc",
        "options"       : "customer-accounts",	
        "options-error" : "merchant-payment-account-error",
        "error"         : "merchant-payment-debit-account-error",
		"previous"      : "merchant-payment-accounts",
		"next"			: "merchant-payment-amount"
    },
    {
        "type"          : "input",
        "name"          : "merchant-payment-amount",
        "save-as"       : "merchantAmount",
        "validation"    : [
            {
                "name"  : "isAmount",
				"type"   : "joi",
				"arguments":"min=1"
            }
        ],
        "error"         : "merchant-payment-amount-error",
        "previous"      : "merchant-payment-accounts",
        "next"          : "merchant-payment-confirm"
    },
    {
        "type"          : "select",
        "name"          : "merchant-payment-confirm",
        "options"       : "confirm-options",
        "charges"       : false,
        "error"         : "merchant-payment-confirm-error",
        "action"        : "transact",
        "external-fetch": {
            "route"     : "merchant-payment",
            "success"   : "api-success",
            "error"     : "api-success"
        },
        "on-cancel"     : "client-page",
        "previous"      : "merchant-payment-amount"
	},
    {
        "type"          : "input",
        "name"          : "mpesa-merchant-amount",
        "save-as"       : "merchantAmount",
        "validation"    : [
            {
                "name"  : "isAmount",
				"type"   : "joi",
				"arguments":"min=1"
            }
        ],
        "error"         : "mpesa-merchant-amount-error",
        "previous"      : "merchant-payment-accounts",
        "next"          : "mpesa-merchant-confirm"
    },
    {
        "type"          : "select",
        "name"          : "mpesa-merchant-confirm",
        "options"       : "confirm-options",
        "charges"       : false,
        "error"         : "mpesa-merchant-confirm-error",
        "action"        : "transact",
        "external-fetch": {
            "route"     : "mpesa-merchant-payment",
            "success"   : "mpesa-merchant-payment-success",
            "error"     : "mpesa-merchant-payment-success"
        },
        "on-cancel"     : "client-page",
        "previous"      : "mpesa-repayment-amount"
    },
    {
		"type"      : "alert",
		"name"      : "mpesa-merchant-payment-success"
    },
	{
		"type"      : "select",
		"name"      : "loan-repayment-success",
		"options"   : "yes-no-options",
		"error"     : "loan-repayment-success-error",
		"action"    : "navigate",
		"on-accept" : "client-page",
		"on-cancel" : "logout",
		"previous"  : "loans-page"
    },
    {
		"type"      : "select",
		"name"      : "merchant-payment-account-error",
		"options"   : "yes-no-options",
		"error"     : "merchant-payment-account-error-error",
		"action"    : "navigate",
		"on-accept" : "client-page",
		"on-cancel" : "logout"
	},
    {
		"type"      : "select",
		"name"      : "merchant-payment-presentment-account-error",
		"options"   : "yes-no-options",
		"error"     : "merchant-payment-presentment-account-error-error",
		"action"    : "navigate",
		"on-accept" : "client-page",
		"on-cancel" : "logout"
	}
]
